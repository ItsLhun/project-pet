<main>
  <h1>{{pet.name}}'s profile</h1>
  <section class='profile-section dashboard-component'>

    <div class='profile-picture-wrapper'>
      <div>

        <div class='camera-wrapper'><img
            src='/images/camera-icon.svg'
            alt=''
          /></div>
        <div class='profile-circle'>
          <img
            class='profile-pic'
            src='{{pet.profilePicture}}'
            alt='{{pet.name}} profile picture'
          />
          <form
            class='upload-picture-form'
            method='POST'
            style='display: none'
            action='/pet/upload-picture/{{pet._id}}'
            enctype='multipart/form-data'
          >
            <input
              class='upload-profile-picture'
              name='profilePicture'
              type='file'
              accept='image/*'
            />
            <button></button>
          </form>
        </div>
      </div>
    </div>
    <div class='profile-info'>
      <div><strong>Name: </strong><span>{{pet.name}}</span></div>
      <div><strong>Birthday: </strong><span>
          {{#if pet.birthday}}
            {{pet.birthday}}
          {{else}}
            Not set
          {{/if}}
        </span></div>
      <div><strong>Species: </strong><span>{{pet.species}}</span></div>
    </div>
    <fieldset class='dashboard-component authorized'>
      <legend id='authorized-users' class='component-title'>Authorized users</legend>
      <div id='authorized-users-list'>
        <div id='users'>
          <div class='pet-wrapper-summary'>
            {{#each pet.authorized}}
              <div class='miniature-wrapper'>
                <!-- <a href=''> -->
                <div class='miniature-image-holder'>
                  {{#if profilePicture}}
                    <img src='{{this.profilePicture}}' alt='profile picture' />
                  {{else}}
                    <img src='/images/default-profile-picture.png' alt='' />
                  {{/if}}
                </div>
                <h5>{{this.username}}</h5>
                <!-- </a> -->
              </div>
            {{/each}}
          </div>
        </div>
        <div id='add-auth-user-button'>+</div>
      </div>
      <div class='collapsible'>
        <div class='collapsible-content'>
          <form method='POST' action='/message/authorize/{{pet._id}}'>
            <label for='user-search-input'>Search username</label>
            <input
              id='user-search-input'
              name='username'
              list='users-list'
              type='text'
              oninput='searchUser(this.value)'
              autocomplete='off'
            />
            <label for='note'>Note:</label>
            <textarea id='message-note' name='note' type='text'></textarea>
            <datalist id='users-list'>
            </datalist>
            <button>Send invitation</button>
          </form>
        </div>
      </div>

    </fieldset>
    <div class='edit-wrapper top-level'><img
        src='/images/pencil.svg'
        alt=''
      /></div>
  </section>

  <fieldset class='dashboard-component'>
    <legend class='component-title'>Medical</legend>
    <div class='profile-info'>
      <div><strong>Medical Id: </strong><span>
          {{#if pet.medicalId}}
            {{pet.medicalId}}
          {{else}}
            Not set
          {{/if}}</span></div>
      <div><strong>Veterinarian: </strong><span>
          {{#if pet.veterinarian}}
            {{pet.veterinarian}}
          {{else}}
            Not set
          {{/if}}
        </span></div>
    </div>
    <div class='edit-wrapper'><img src='/images/pencil.svg' alt='' /></div>

  </fieldset>
  <fieldset class='dashboard-component'>
    <legend class='component-title'>Nutrition</legend>
    <div class='profile-info'>
      <div><strong>Food Brand: </strong><span>{{pet.foodBrand}}</span></div>
      <div><strong>Daily Serving: </strong><span>
          {{#if pet.serving}}
            {{pet.serving}}
          {{else}}
            Not set
          {{/if}}
        </span></div>
      <div><strong>Alergies: </strong><span>
          {{#if pet.alergies}}
            {{pet.alergies}}
          {{else}}
            None
          {{/if}}</span></div>
    </div>
    <div class='edit-wrapper'><img src='/images/pencil.svg' alt='' /></div>

  </fieldset>
  <div id='calendar' class='dashboard-component'></div>
</main>
<script src='https://unpkg.com/axios/dist/axios.min.js'></script>
<script src='/scripts/calendar-api.js'></script>
<script src='/scripts/calendarjs.js'></script>
<script src='/scripts/calendar-options.js'></script>
<script src='/scripts/user-authorization.js'></script>
<script>
  const events =
  {{{json events}}}; calendarInstance.setEvents(events);
</script>